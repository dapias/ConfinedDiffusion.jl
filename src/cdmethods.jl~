"""Function that computes the difference of the cell number associated to the particle by comparing its current x-position with the previous one"""
function cellchange(p :: Particle, sigma::Float64)
    """It returns a number of cell based on a x-position"""
    function cell(r::Array{Float64,1})
        if -pi/(2*sigma) < r[1] < 3*pi/(2*sigma)
            cellnumber = 0
        elseif r[1] > 3*pi/(2*sigma)
            a = r[1] - 3*pi/(2*sigma)
            cellnumber = div(a,(2*pi/sigma)) + 1  #2pi/sigma is the period of the wall
        else 
            a = r[1] + pi/(2*sigma)
            cellnumber = div(a, (2*pi/sigma)) - 1
        end
        cellnumber
    end

    prevcell = cell(p.rprevious)
    currentcell = cell(p.r)

    return abs(currentcell - prevcell)

end

function incell(p::Particle, b::Boundary)
    if p.r[2] < b.shape(p.r[1])
        return true
    else
        return false
    end
end
